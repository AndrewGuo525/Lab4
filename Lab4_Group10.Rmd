---
title: "Lab4_Group10"
author: "Jiayi Guo"
date: "2022-11-09"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r message=FALSE,warning=FALSE}
library(datasets)
library(tidyverse)
library(fields)
```

```{r}
k_means <- function(data, k, iter){
  set.seed(111)
  # Remove the label of data
  data <- data[, -5]
  
  # Randomly assigning each observation to a cluster
  label <- sample(1:k, 150, replace = T)
  
  for(t in iter){
    
    # Calculate the centroids for each of the cluster
    newcentr <- data.frame()

    for(m in seq_len(k)){
      idx <- data[label==m,]
      newcentr<- rbind(newcentr, apply(idx, 2, mean))
    }
    
    label <- c()
    
    for (i in seq_len(150)) {
      dist <- c()
      for(n in seq_len(k)){
        # Calculate the distance from each point to each of the centroids
        dist[n] <- rdist(data[i,], newcentr[n,])
        # Calculate the minimum distance for each point to the centroids
        label[i] <- which.min(dist)
      }
    }
    
  }
  return(label)
}


```


```{r}
label<- k_means(iris,3,50)
table(label)
```




